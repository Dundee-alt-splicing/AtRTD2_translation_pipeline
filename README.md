# AtRTD2_translation_pipeline
----------------------------
**Overview**
===============
----------------------------

This pipeline has been developed to translate transcripts present in Arabidopsis Reference Transcript dataset v2 (AtRTD2) fasta file.  Translations were generated by two modes: 1) selecting the transcript for each gene which generated the longest open reading frame (ORF) based on GFF3 annotation, defining the position of the translation start AUG in this transcript and using this translation start site (fixed AUG) as the reference point for translation of all of the transcripts of that gene; or 2) for transcripts lacking the fixed AUG, translating individual transcripts and identifying the longest ORF.

The pipeline aims to overcome problems of mis-annotation of protein products from transcript isoforms generated by the generally used translation programmes that simply identify ORFs of a minimum length. In this case, transcript isoforms which contain a premature termination codon (PTC) are often incorrectly annotated as having a ORF beginning at an AUG downstream of the PTC(more information at Brown et al. 2015: http:/​/​dx.​doi.​org/​10.​1105/​tpc.​15.​00572). It is, therefore, important that transcript isoforms are translated form the “authentic” translation AUG.  

The first part of the program uses the first translation mode. To find the authentic AUG, the program identifies the longest ORFs in each gene using the transcript CDS coordinates present in the GFF3 file (Araport). Then, the programme defines that AUG as the translation start position for all the transcripts of that gene and translates the transcript models using that AUG as the starting position.
 
Some transcript isoforms do not contain the fixed AUG due to alternative splicing or differential transcription start sites. To translate these transcripts, the second part of the program uses the second mode of translation (commonly used by most translation programs). In this case, transcripts are usually translated into the 6 possible ORFs and the longest translated segment selected. Although, as described above, this methodology generally presents certain limitations, as only transcript isoforms without the fixed AUG are being translated, for the most part, accurate translations are generated. 

Since this methodology is reliant on fixing the AUG using the models present in the GFF3 file, some transcript models will not be translated. The pipeline returns lists of transcript/gene ids according to the reason that translation was unsuccessful.

- **non-gff3_locus.txt**: If the gene is not in the gff file.

- **retrotransposons.txt**: If the gene is a retrotransposon.

- **start_absent.txt**: In some cases the AUG position fixed in the GFF3 models cannot be assigned to the transcripts in the GTF annotation (for example, due to the transcript model in the GTF annotation being shorter than the model in the GFF3 annotation).

- **non_atg_start.txt**: For those cases in which the annotated starting site in the GFF3 file is not an ATG.



----------------------------
**Requirements**
================
----------------------------

This pipeline has been developed in Python 3 for Linux OS. 

To install Python 3 we recommend the official website: https://www.python.org/downloads/

Furthermore, the pipeline requires Python's bioinformatic library: Biopython (version 1.68).

To install Biopython we recommend the official website: http://biopython.org/wiki/Download



**Commands**
============

The pipeline may take different arguments to perform the analysis. To read the documentation of the arguments run the command:

```
python3 run_analysis.py -h
```


The following arguments are always required:

- **-fix**  | **--fix-aug**: Boolean. If True, the program fix in each gene the AUG from the transcript that translates to the longest ORF. If False, the program translates the longest ORF of each single transcript.

- **-fa**  | **--fasta**: Path of the fasta file.

- **-o**  | **--output-file**: Name for the output file



If **-fix** is True, then the following input files are required:

- **-g3**  | **--gff3**: Path of the GFF3 file.

- **-g**  | **--gtf**: Path of the GTF file.



If **-fix** is False, it is possible to select the sequences on the fasta file to be translated by specifying the following arguments:

- **-l**  | **--len**: Minimum length of the translated peptide to be kept in the output file (default: 0).

- **-i**  | **--ids**: Path to an input file containing the list of gene/transcripts ids to translated from the fasta file.

- **-f**  | **--filter**: Specify if the ids for the **--ids** are "gene" or "transcript" ids.



**Analysis**
------------
The input files used in this analysis are inside the folder "input_files".

First, we translate the transcript models present in AtRTD2 by finding and fixing the AUG:

``` 
python3 run_analysis.py --fix True --fasta ./input_files/AtRTD2_19April2016.fa --gtf ./input_files/AtRTD2_19April2016.gtf --gff3 ./input_files/Araport11_genes.20151202.gff3 --output AtRTD2_translations 
```

This analysis produces the following proteins:

``` 
AtRTD2_translations.fa
``` 

and the following list of transcripts/genes that could not be translated by fixing the AUG:

``` 
No universal ATG among annotated CDS models:  0
Total models considered:  74151

locus id not in GFF3 AtRTD2_translations_non-gff3_locus.txt)  6635
transposon loci AtRTD2_translations_retrotransposons.txt)  37
rep atg not in transcript (AtRTD2_translations_start_absent.txt)  4339
start position is not ATG (AtRTD2_translations_non_atg_start.txt):  90
``` 



Next, we proceed to translate the transcripts which were not translated because they did not contain the fixed AUG, either because:

- The AUG starting position fixed in the GFF3 falls outside the range of the transcripts models annotated in the GTF model ("AtRTD2_translations_start_absent.txt")

or

- The annotated starting position in the GFF3 file is not an ATG ("AtRTD2_translations_non_atg_start.txt").


```
python3 run_analysis.py --fix False --fasta ./input_files/AtRTD2_19April2016.fa --ids ./AtRTD2_translations_start_absent.txt --filter transcript --output AtRTD2_start_absent_translations 
```

```
python3 run_analysis.py --fix False --fasta ./input_files/AtRTD2_19April2016.fa --ids ./AtRTD2_translations_non_atg_start.txt --filter transcript --len 100 --output AtRTD2_non_atg_translations 
```


These analysis produces respectively the following fasta files:

``` 
AtRTD2_start_absent_translations.fa
``` 

``` 
AtRTD2_non_atg_translations.fa
``` 


-----------
**LICENSE**
===========

This pipeline is released under the MIT license
